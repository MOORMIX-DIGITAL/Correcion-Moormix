<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoormixDigital - Tecnología Móvil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo personalizado para las opciones seleccionadas en el modal */
        [data-selected="true"] {
            border-width: 2px;
        }
        /* Ocultar las flechas de número en input type="number" */
        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        /* Firefox */
        input[type=number] {
            -moz-appearance: textfield;
        }

        /* Clases de utilidad para el acordeón (Toggle) */
        .finance-content-hidden {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 0 1rem; /* Padding horizontal inicial */
        }

        .finance-content-visible {
            max-height: 1000px; /* Suficientemente grande para el contenido */
            transition: max-height 0.3s ease-in, padding 0.3s ease-in;
            padding: 1rem; /* Padding vertical y horizontal final */
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

    <header class="bg-cyan-600 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 text-white text-xl md:text-2xl font-bold whitespace-nowrap overflow-hidden">
                    MoormixDigital
                </div>

                <nav class="hidden sm:flex space-x-4">
                    <button id="btn-inicio" class="nav-btn text-white hover:bg-cyan-700 px-3 py-2 rounded-md text-sm font-medium transition-colors">Inicio</button>
                    <button id="btn-catalogo" class="nav-btn text-white hover:bg-cyan-700 px-3 py-2 rounded-md text-sm font-medium transition-colors">Catálogo</button>
                    <button id="btn-nosotros" class="nav-btn text-white hover:bg-cyan-700 px-3 py-2 rounded-md text-sm font-medium transition-colors">Nosotros</button>
                    <button id="btn-contacto" class="nav-btn text-white hover:bg-cyan-700 px-3 py-2 rounded-md text-sm font-medium transition-colors">Contacto</button>
                </nav>

                <div class="sm:hidden">
                    <button id="menu-toggle" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-cyan-200 hover:text-white hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false">
                        <svg class="block h-6 w-6" id="menu-icon-open" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                        </svg>
                        <svg class="hidden h-6 w-6" id="menu-icon-close" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="sm:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <button id="mobile-btn-inicio" class="nav-btn text-white hover:bg-cyan-700 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Inicio</button>
                <button id="mobile-btn-catalogo" class="nav-btn text-white hover:bg-cyan-700 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Catálogo</button>
                <button id="mobile-btn-nosotros" class="nav-btn text-white hover:bg-cyan-700 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Nosotros</button>
                <button id="mobile-btn-contacto" class="nav-btn text-white hover:bg-cyan-700 block px-3 py-2 rounded-md text-base font-medium w-full text-left">Contacto</button>
            </div>
        </div>
    </header>

    <main class="flex-grow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

            <section id="page-inicio" class="content-page space-y-12">
                <div class="text-center bg-white rounded-xl p-6 sm:p-12 shadow-xl">
                    <h1 class="text-3xl sm:text-5xl font-extrabold text-cyan-600 mb-4">Bienvenido a MoormixDigital</h1>
                    <p class="text-base sm:text-xl text-gray-700 mb-8">Tu destino para la última tecnología en smartphones. Calidad, garantía y los mejores precios.</p>
                    <img src="https://placehold.co/1200x400/000000/ffffff?text=Banner+Principal+Tecnología" alt="Banner de Tecnología" class="w-full rounded-lg shadow-inner mb-8">
                    <button id="btn-ir-catalogo" class="bg-pink-500 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-pink-600 transition-colors shadow-lg">
                        Ver Catálogo Ahora
                    </button>
                </div>
            </section>

            <section id="page-catalogo" class="content-page hidden">
                <h2 class="text-3xl font-bold text-gray-900 mb-6 border-b-2 border-cyan-600 pb-2">Catálogo de Productos</h2>

                <div class="mb-8 flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4">
                    <input type="text" id="search-input" placeholder="Buscar por nombre o descripción..." class="flex-grow p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-cyan-600 focus:border-cyan-600">
                    <select id="sort-order" class="p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-cyan-600 focus:border-cyan-600">
                        <option value="name">Ordenar por Nombre</option>
                        <option value="price">Ordenar por Precio</option>
                    </select>
                </div>

                <div id="catalogo-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6">
                    </div>
            </section>

            <section id="page-nosotros" class="content-page hidden bg-white rounded-xl p-6 sm:p-10 shadow-xl space-y-6">
                <h2 class="text-3xl font-bold text-gray-900 border-b-2 border-pink-500 pb-2">Acerca de MoormixDigital</h2>
                <p class="text-gray-700 text-base sm:text-lg">
                    Somos un equipo apasionado por la tecnología móvil, dedicados a ofrecer a nuestros clientes en Ecuador acceso a los últimos modelos de smartphones con la mejor relación calidad-precio. Nuestra misión es simple: conectar personas con la tecnología que necesitan, ofreciendo una experiencia de compra transparente y segura.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center pt-4">
                    <div class="p-4 bg-cyan-100 rounded-lg shadow">
                        <h3 class="text-xl font-semibold text-cyan-700">Calidad Garantizada</h3>
                        <p class="text-gray-600">Solo vendemos productos nuevos con garantía de 1 año.</p>
                    </div>
                    <div class="p-4 bg-pink-100 rounded-lg shadow">
                        <h3 class="text-xl font-semibold text-pink-700">Precios Competitivos</h3>
                        <p class="text-gray-600">Buscamos siempre el mejor precio con el IVA ya incluido.</p>
                    </div>
                    <div class="p-4 bg-gray-200 rounded-lg shadow">
                        <h3 class="text-xl font-semibold text-gray-700">Atención Personalizada</h3>
                        <p class="text-gray-600">Te asesoramos vía WhatsApp para una compra ideal.</p>
                    </div>
                </div>
            </section>

            <section id="page-contacto" class="content-page hidden bg-white rounded-xl p-6 sm:p-10 shadow-xl space-y-6">
                <h2 class="text-3xl font-bold text-gray-900 border-b-2 border-cyan-600 pb-2">Contáctanos</h2>
                <p class="text-gray-700 text-base sm:text-lg">
                    ¿Tienes preguntas, reclamos o sugerencias? Escríbenos y te responderemos a la brevedad.
                </p>

                <form id="contact-form" class="space-y-4">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                        <input type="text" id="name" name="name" required class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-600 focus:border-cyan-600">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Correo Electrónico</label>
                        <input type="email" id="email" name="email" required class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-600 focus:border-cyan-600">
                    </div>
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700">Mensaje</label>
                        <textarea id="message" name="message" rows="4" required class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-cyan-600 focus:border-cyan-600"></textarea>
                    </div>
                    <button type="submit" class="w-full bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-cyan-700 transition-colors shadow-lg">
                        Enviar Consulta por Correo
                    </button>
                    <p id="form-message" class="hidden text-center text-sm mt-4"></p>
                </form>

                <p class="text-center pt-4">O contáctanos directamente por **WhatsApp:**</p>
                <div class="text-center">
                    <a href="https://wa.me/593967427594" target="_blank" class="inline-flex items-center bg-green-500 text-white font-bold py-3 px-6 rounded-full hover:bg-green-600 transition-colors shadow-lg">
                        <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M12.04 2c-5.514 0-9.982 4.468-9.982 9.982 0 1.942.544 3.805 1.577 5.433L2 22.018l4.636-1.218a10.046 10.046 0 005.404 1.502c5.514 0 9.982-4.468 9.982-9.982S17.554 2 12.04 2zm3.89 13.928c-.145.242-.857.697-1.18.835-.32.138-.663.208-1.002.106-.445-.13-.854-.234-1.258-.337-.32-.081-.69-.168-1.082.518-.396.697-1.284 1.089-1.63 1.157-.348.069-.64.032-.962-.072-.258-.08-.42-.152-.61-.318-.198-.17-.464-.537-.468-.897-.005-.36 0-.8.026-1.196.026-.39.083-.728.14-.99.057-.26.242-.647.382-.895.14-.247.323-.465.51-.71.185-.246.47-.6.54-.77.07-.17-.038-.306-.115-.458-.076-.15-.175-.32-.27-.47-.097-.152-.19-.24-.265-.357-.074-.116-.252-.3-.14-.523.11-.22.383-.393.578-.42.195-.025.41-.01.597.042.188.053.376.126.54.34.16.21.25.45.34.618.09.168.18.35.32.553.14.2.285.4.425.59.14.188.297.382.44.57.14.188.24.288.33.473.09.184.09.38.046.54-.044.158-.293.26-.44.34-.145.08-.34.19-.533.284z"/></svg>
                        Escribir a MoormixDigital
                    </a>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-gray-800 text-white p-4 mt-auto">
        <div class="max-w-7xl mx-auto text-center text-sm">
            <p>&copy; 2024 MoormixDigital. Todos los derechos reservados. | Desarrollado con ❤️ y JavaScript.</p>
        </div>
    </footer>

    <div id="info-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[9999] hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto relative transform transition-all">
            <button id="close-modal" class="absolute top-4 right-4 text-gray-500 hover:text-gray-900 transition-colors text-3xl font-bold p-1">
                &times;
            </button>

            <div id="modal-content" class="p-4 sm:p-8">
                </div>
        </div>
    </div>


    <script>
        // Array de productos (inicia aquí)
        const products = [
            {
                name: "Infinix Smart 9 HD",
                brand: "Infinix",
                tag: "Oferta",
                shortDescription: "128GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/infinixsmart9hd.png", "img/tecnospark10prolateral.png", "img/tecnospark10protrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G88",
                    "Sistema operativo Android 13",
                    "Pantalla 6.8\" FHD+ IPS 90GHz",
                    "Cámara frontal 32 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash 360°",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "128GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "128GB", ram: "16GB", color: "Titanium Gold", price: 120.75, stock: 15 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 135.50, stock: 10 },
                ],
            },
            {
                name: "Tecno Spark 20 Pro",
                brand: "Tecno",
                tag: "Nuevo",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos, Multitareas y Estudiantiles\nHuella lateral",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark20pro.png", "img/tecnospark20prolateral.png", "img/tecnospark20protrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G91",
                    "Sistema operativo Android 14",
                    "Pantalla 6.78\" FHD +IPS 120GHz",
                    "Cámara frontal 32 MP",
                    "Cámara trasera 108 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash 360°",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 150.00, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Titanium Gold", price: 150.00, stock: 15 },
                ],
            },
            {
                name: "Tecno Spark 20",
                brand: "Tecno",
                tag: "Pocas Unidades",
                shortDescription: "128GB/8GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella lateral",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark20.png", "img/tecnospark20lateral.png", "img/tecnospark20trasero.png"],
                specs: [
                    "Procesador MediaTek Helio G85",
                    "Sistema operativo Android 13",
                    "Pantalla 6.6\" HD+IPS 90GHz",
                    "Cámara frontal 32 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash 360°",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "64GB", ram: "6GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "64GB", ram: "6GB", color: "Titanium Gold", price: 120.75, stock: 15 },
                ],
            },
            {
                name: "Tecno Spark 30",
                brand: "Tecno",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos, Multitareas, Estudiantil y Gamers\nHuella lacteral",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark30.png", "img/tecnospark30lateral.png", "img/tecnospark30trasero.png"],
                specs: [
                    "Procesador MediaTek Helio G91",
                    "Sistema operativo Android 14",
                    "Pantalla 6.78\" FHD +IPS 90GHz",
                    "Cámara frontal 16 MP",
                    "Cámara trasera 64 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Flash doble trasera",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Negro Tinta", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Hielo Astral", price: 120.75, stock: 15 },
                ],
            },
            {
                name: "Tecno Spark 30 Pro",
                brand: "Tecno",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark30pro.png", "img/tecnospark30prolateral.png", "img/tecnospark30protrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G100",
                    "Sistema operativo Android 14",
                    "Pantalla 6.78\" AMOLED FHD IPS 120GHz",
                    "Cámara frontal 13 MP",
                    "Cámara trasera 108 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Titanium Gold", price: 120.75, stock: 15 },
                ],
            },
            {
                name: "Tecno Spark 30 C",
                brand: "Tecno",
                shortDescription: "256GB/8GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark30c.png", "img/tecnospark30clateral.png", "img/tecnospark30ctrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G81",
                    "Sistema operativo Android 14",
                    "Pantalla 6.67\" HD +IPS 120GHz",
                    "Cámara frontal 8 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "8GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "8GB", color: "Titanium Gold", price: 120.75, stock: 15 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 8 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Titanium Gold", price: 120.75, stock: 5 },
                ],
            },
            {
                name: "Tecno Spark 40 Pro",
                brand: "Tecno",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark40pro.png", "img/tecnospark40prolateral.png", "img/tecnospark40protrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G100",
                    "Sistema operativo Android 15 HIOS",
                    "Pantalla 6.78\" FHD+ +IPS 144GHz",
                    "Cámara frontal 13 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5200mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Azul", price: 120.75, stock: 15 },
                    ],
            },
            {
                name: "Tecno Spark 40 Pro+",
                brand: "Tecno",
                shortDescription: "64GB/6GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnospark40pro+.png", "img/tecnospark40pro+lateral.png", "img/tecnospark40pro+trasero.png"],
                specs: [
                    "Procesador MediaTek Helio G100",
                    "Sistema operativo Android 15 HIOS",
                    "Pantalla 6.78\" FHD+ +IPS 144GHz",
                    "Cámara frontal 13 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5200mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Blanco", price: 120.75, stock: 15 },
                ],
            },
            {
                name: "Tecno Camon 30",
                brand: "Tecno",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla\nIncluye auriculares inalambricos",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnocamon30.png", "img/tecnocamon30lateral.png", "img/tecnocamon30trasero.png"],
                specs: [
                    "Procesador MediaTek Helio G99 Ultimate",
                    "Sistema operativo Android 14 HIOS",
                    "Pantalla 6.78\" AMOLED FHD+ +IPS 120GHz",
                    "Cámara frontal 50 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Blanco", price: 120.75, stock: 15 },
                ]
            },
            {
                name: "Tecno Camon 40",
                brand: "Tecno",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/tecnocamon40.png", "img/tecnocamon40lateral.png", "img/tecnocamon40trasero.png"],
                specs: [
                    "Procesador MediaTek Helio G100 Ultimate",
                    "Sistema operativo Android 15 HIOS",
                    "Pantalla 6.78\" AMOLED FHD+ +IPS 120GHz",
                    "Cámara frontal 32 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5200mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Celeste", price: 120.75, stock: 20 },
                ],
            },
            {
                name: "Honor x5b Plus",
                brand: "Honor",
                shortDescription: "256GB/8GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/honorx5bplus.png", "img/honorx5bpluslateral.png", "img/honorx5bplustrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G36",
                    "Sistema operativo Android 13",
                    "Pantalla 6.56\" FHD+ +IPS 90GHz",
                    "Cámara frontal 5 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5200mAh",
                    "Tarjeta de memoria",
                    "Flash",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "8GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "8GB", color: "Lila", price: 120.75, stock: 15 },
                    ]
            },
            {
                name: "Honor x6c",
                brand: "Honor",
                shortDescription: "256GB/12GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella lateral",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/honorx6c.png", "img/honorx6clateral.png", "img/honorx6ctrasero.png"],
                specs: [
                    "Procesador MediaTek Helio G81 Ultra",
                    "Sistema operativo Android 15 MagicOS",
                    "Pantalla 6.61\" HD+ +IPS 120GHz",
                    "Cámara frontal 5 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5300mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash LED",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "12GB", color: "Celeste", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "12GB", color: "Blanco", price: 120.75, stock: 15 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Celeste", price: 120.75, stock: 15 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Blanco", price: 120.75, stock: 15 },
                    ],
            },
            {
                name: "Honor x7c",
                brand: "Honor",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nReconocimiento facial\nHuella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' ***
                images: ["img/honorx7c.png", "img/honorx7clateral.png", "img/honorx7ctrasero.png"],
                specs: [
                    "Procesador Qualcomm Snapdragon 685",
                    "Sistema operativo Android 14 MagicOS",
                    "Pantalla 6.78\" TFTLCD FHD+ +IPS 120GHz",
                    "Cámara frontal 8 MP",
                    "Cámara trasera 108 MP",
                    "Batería 5200mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Blanco", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Negro", price: 120.75, stock: 15 },
                    { almacenamiento: "256GB", ram: "16GB", color: "verde", price: 120.75, stock: 15 },
                ],
            },
            {
                name: "Honor x8c",
                brand: "Honor",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\Huella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' (Estas son las que tenían placeholders) ***
                images: ["img/honorx8c.png", "img/honorx8clateral.png", "img/honorx8ctrasero.png"],
                specs: [
                    "Procesador Snapdragon 685",
                    "Sistema operativo Android 15 MagicOS",
                    "Pantalla 6.78\" AMOLED HD+ +IPS 120GHz",
                    "Cámara frontal 8 MP",
                    "Cámara trasera 108 MP",
                    "Batería 5150mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP54",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Cian", price: 120.75, stock: 20 },
                    { almacenamiento: "512GB", ram: "16GB", color: "Cian", price: 120.75, stock: 15 },
                    ],
            },
            {
                name: "Honor x9b",
                brand: "Honor",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\Huella en pantalla",
                // *** CAMBIO: Ruta de imágenes a 'img/' (Estas son las que tenían placeholders) ***
                images: ["img/honorx9b.png", "img/honorx9b_2.png", "img/honorx9b_3.png"],
                specs: [
                    "Procesador Snapdragon 695 5G",
                    "Sistema operativo Android 13 MagicOS",
                    "Pantalla 6.78\" AMOLED FHD+ 120GHz",
                    "Cámara frontal 16 MP",
                    "Cámara trasera 108 MP",
                    "Batería 5800mAh",
                    "Tarjeta de memoria",
                    "Resistencia al polvo y salpicadura de agua IP53",
                    "Flash dual",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Plata", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Negro", price: 120.75, stock: 15 },
                    ],
            },
            {
                name: "Samsung A25",
                brand: "Samsung",
                shortDescription: "128GB/8GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nSistema Operativo Samsung ONE UI",
                // *** CAMBIO: Ruta de imágenes a 'img/' (Estas son las que tenían placeholders) ***
                images: ["img/samsunga25.png", "img/samsunga25_2.png", "img/samsunga25_3.png"],
                specs: [
                    "Procesador Exynos 1280",
                    "Sistema operativo Android 14 One UI 6",
                    "Pantalla 6.5\" Super AMOLED FHD+ 120GHz",
                    "Cámara frontal 13 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Flash",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "128GB", ram: "8GB", color: "Azul", price: 120.75, stock: 20 },
                    { almacenamiento: "128GB", ram: "8GB", color: "Negro", price: 120.75, stock: 15 },
                    ],
            },
            {
                name: "Xiaomi Redmi 13C",
                brand: "Xiaomi",
                shortDescription: "256GB/16GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla\nSistema Operativo Xiaomi HyperOS",
                // *** CAMBIO: Ruta de imágenes a 'img/' (Estas son las que tenían placeholders) ***
                images: ["img/xiaomiredmi13c.png", "img/xiaomiredmi13c_2.png", "img/xiaomiredmi13c_3.png"],
                specs: [
                    "Procesador MediaTek Helio G85",
                    "Sistema operativo Android 13",
                    "Pantalla 6.74\" IPS LCD 90GHz",
                    "Cámara frontal 8 MP",
                    "Cámara trasera 50 MP",
                    "Batería 5000mAh",
                    "Tarjeta de memoria",
                    "Flash",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Negro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Azul", price: 120.75, stock: 15 },
                    ],
            },
            {
                name: "Motorola G54",
                brand: "Motorola",
                shortDescription: "256GB/12GB RAM<br>1 Año de Garantía",
                longDescription: "IMAGEN DE REFERENCIA.\nBuen rendimiento para Usos Básicos y Estudiantiles\nHuella en pantalla\nSistema Operativo Motorola",
                // *** CAMBIO: Ruta de imágenes a 'img/' (Estas son las que tenían placeholders) ***
                images: ["img/motorolag54.png", "img/motorolag54_2.png", "img/motorolag54_3.png"],
                specs: [
                    "Procesador MediaTek Dimensity 7020",
                    "Sistema operativo Android 13",
                    "Pantalla 6.5\" IPS LCD 120GHz",
                    "Cámara frontal 16 MP",
                    "Cámara trasera 50 MP",
                    "Batería 6000mAh",
                    "Tarjeta de memoria",
                    "Flash",
                    "Dual Sim",
                    "USB tipo C"
                ],
                variants: [
                    { almacenamiento: "256GB", ram: "16GB", color: "Gris Oscuro", price: 120.75, stock: 20 },
                    { almacenamiento: "256GB", ram: "16GB", color: "Azul", price: 120.75, stock: 15 },
                ]
            }
        ];

        // 1. Cálculo del precio con IVA (15%)
        products.forEach(product => {
            product.variants.forEach(variant => {
                // El precio con IVA es el precio de contado
                variant.priceWithTax = variant.price * 1.15;
            });
        });

        // RECARGOS POR FINANCIAMIENTO (en porcentaje - Ficticio para el ejemplo)
        const FINANCE_FEES = {
            '3': 0.03, // 3 meses: 3% de recargo sobre el precio con IVA
            '6': 0.06, // 6 meses: 6% de recargo
            '9': 0.09  // 9 meses: 9% de recargo
        };

        // Días de frecuencia de pago
        const FREQUENCY_DAYS = {
            'semanal': 7,
            'quincenal': 15,
            'mensual': 30
        };


        // *** CAMBIO CLAVE: Función para obtener la imagen ***
        // Ahora solo muestra el placeholder si la ruta está VACÍA o es un link a internet
        const getImageSrc = (path, productName) => {
            if (!path || path.startsWith('http')) {
                // Placeholder si no hay ruta o es un link externo (aunque ya las actualicé a img/)
                return `https://placehold.co/800x800/ffffff/000000?text=${productName.replace(/\s/g, '+')}+Imagen`;
            }
            // Usa la ruta local 'img/nombre_archivo.png'
            return path;
        };
        // *******************************************************


        // 2. Función para renderizar los productos en el catálogo
        function renderProducts(productsToRender) {
            const catalogoGrid = document.getElementById('catalogo-grid');
            catalogoGrid.innerHTML = ''; // Limpiar el contenedor
            if (productsToRender.length === 0) {
                catalogoGrid.innerHTML = `<p class="col-span-full text-center text-gray-500">No se encontraron productos.</p>`;
                return;
            }
            productsToRender.forEach((product, index) => {
                // Selecciona el color del tag. Por defecto usa cyan-600
                const tagColor = product.tag === "Oferta" ? "bg-red-500" : (product.tag === "Nuevo" ? "bg-green-500" : (product.tag === "Pocas Unidades" ? "bg-yellow-500" : (product.tag ? "bg-pink-500" : "bg-cyan-600")));
                const tagHtml = product.tag ? `<span class="absolute top-2 right-2 ${tagColor} text-white text-xs font-semibold px-2 py-1 rounded-full uppercase shadow-md">${product.tag}</span>` : '';

                // Usar el precio de la primera variante para la tarjeta del catálogo
                const firstVariantPriceWithTax = product.variants[0].priceWithTax.toFixed(2);

                const productCard = `
                    <div class="bg-white p-3 rounded-xl shadow-lg flex flex-col items-center text-center transition-transform hover:scale-105 h-full relative">
                        ${tagHtml}
                        <div class="w-full h-32 flex items-center justify-center mb-2">
                           <img src="${getImageSrc(product.images[0], product.name)}" alt="${product.name}" class="max-w-full max-h-full object-contain rounded-lg">
                        </div>
                        
                        <h3 class="text-base font-semibold text-gray-800 mt-2 mb-1 truncate w-full px-1">${product.name}</h3>
                        <p class="text-gray-500 text-xs mb-3 flex-1">${product.shortDescription}</p>
                       <div class="mb-3">
                            <span class="text-xl font-bold text-cyan-600">
                                $${firstVariantPriceWithTax}
                            </span>
                            <span class="text-xs font-semibold text-gray-500 block leading-none">
                                (+IVA)
                            </span>
                        </div>
                        <button class="info-btn w-full bg-gray-200 text-gray-800 font-bold py-2 rounded-lg text-sm hover:bg-gray-300 transition-colors" data-product-index="${index}">
                            Más Info
                        </button>
                    </div>
                `;
                catalogoGrid.innerHTML += productCard;
            });
            // Añadir listeners a los nuevos botones
            document.querySelectorAll('.info-btn').forEach(button => {
                // Se usa el índice del producto en el array original para referenciarlo en el modal
                button.addEventListener('click', showModal);
            });
        }

        // Función para calcular el pago a plazos
        function calculateInstallment(totalPrice, months, frequency) {
            if (totalPrice <= 0 || months <= 0 || !FREQUENCY_DAYS[frequency]) {
                return { totalFinanced: 0, installment: 0, numPayments: 0, frequencyLabel: "N/A" };
            }

            // 1. Aplicar recargo de financiamiento
            const fee = FINANCE_FEES[months] || 0;
            const totalFinanced = totalPrice * (1 + fee);

            // 2. Determinar el número total de pagos
            const totalDays = months * 30; // Meses a días (estimación)
            const daysPerPayment = FREQUENCY_DAYS[frequency];
            const numPayments = Math.floor(totalDays / daysPerPayment);

            // 3. Calcular el valor de cada pago
            const installment = totalFinanced / numPayments;

            // 4. Etiqueta para el resultado
            let frequencyLabel = "";
            switch (frequency) {
                case 'semanal': frequencyLabel = "pago semanal"; break;
                case 'quincenal': frequencyLabel = "pago quincenal"; break;
                case 'mensual': frequencyLabel = "pago mensual"; break;
            }

            return {
                totalFinanced: totalFinanced,
                installment: installment,
                numPayments: numPayments,
                frequencyLabel: frequencyLabel
            };
        }


        // 3. Función para mostrar el modal con la información del producto
        function showModal(event) {
            const index = event.target.getAttribute('data-product-index');
            const product = products[index];
            const modal = document.getElementById('info-modal');
            const modalContent = document.getElementById('modal-content');

            // Recolectar opciones únicas para cada categoría
            const uniqueOptions = {
                almacenamiento: [...new Set(product.variants.map(v => v.almacenamiento))].sort(),
                ram: [...new Set(product.variants.map(v => v.ram))].sort(),
                color: [...new Set(product.variants.map(v => v.color))].sort()
            };

            // Establecer la variante inicial (la que tiene más stock o la primera)
            let selectedVariant = product.variants.find(v => v.stock > 0) || product.variants[0];

            // Generar las opciones dinámicamente
            let optionsHtml = '';
            for (const key in uniqueOptions) {
                const label = key.charAt(0).toUpperCase() + key.slice(1);
                optionsHtml += `
                    <div class="mb-4">
                        <p class="text-gray-700 font-semibold mb-2">${label}:</p>
                        <div class="flex flex-wrap gap-2" id="options-${key}">
                            ${uniqueOptions[key].map(option => `
                                <button class="option-btn px-4 py-2 border rounded-full text-sm font-medium transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-100 data-[selected=true]:bg-cyan-600 data-[selected=true]:text-white data-[selected=true]:border-cyan-600" data-option-type="${key}" data-option-value="${option}" ${option === selectedVariant[key] ? 'data-selected="true"' : ''}>
                                    ${option}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Cálculo inicial de plazos
            const initialInstallment = calculateInstallment(selectedVariant.priceWithTax, 3, 'mensual');


            modalContent.innerHTML = `
                <div class="flex flex-col lg:flex-row items-center lg:items-start text-left space-y-8 lg:space-y-0 lg:space-x-8 p-4">
                    <div class="flex flex-col items-center w-full lg:w-1/2">
                        <img id="main-product-image" src="${getImageSrc(product.images[0], product.name)}" alt="${product.name}" class="w-full h-auto max-h-96 object-contain rounded-lg shadow-lg mb-4">
                        
                        <div class="flex space-x-2 overflow-x-auto w-full justify-center">
                            ${product.images.map(image => `
                                <img src="${getImageSrc(image, product.name)}" alt="${product.name}" class="thumbnail w-16 h-16 rounded-md cursor-pointer border-2 border-transparent hover:border-cyan-600 transition-colors" onclick="document.getElementById('main-product-image').src='${getImageSrc(image, product.name)}'">
                            `).join('')}
                        </div>
                    </div>

                    <div class="w-full lg:w-1/2">
                        <span class="bg-pink-500 text-white text-xs font-semibold px-2 py-1 rounded-full uppercase">${product.brand}</span>
                        <h3 class="text-3xl font-bold text-gray-900 mt-2">${product.name}</h3>
                        <p class="text-sm text-gray-500 mt-2">Disponibles: <span id="modal-stock">${selectedVariant.stock}</span>!</p>
                        
                        <div class="my-4 pb-4 border-b border-gray-200">
                            <p class="text-gray-700 font-semibold mb-1">Precio de Contado:</p>
                            <span id="modal-price" class="text-4xl font-extrabold text-cyan-600 block">
                                $${selectedVariant.priceWithTax.toFixed(2)}
                            </span>
                            <span class="text-sm font-semibold text-gray-500">
                                (Precio final con IVA)
                            </span>
                        </div>

                        <div id="finance-accordion" class="mb-6 bg-gray-100 rounded-lg overflow-hidden">
                            <button id="finance-toggle" class="w-full text-left p-4 flex justify-between items-center text-gray-700 font-bold hover:bg-gray-200 transition-colors border-b border-gray-300">
                                <span>Pagar a Plazos (Ver Opciones)</span>
                                <svg id="finance-icon" class="w-5 h-5 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>

                            <div id="finance-content" class="finance-content-hidden">
                                
                                <div class="flex flex-col sm:flex-row gap-4">
                                    
                                    <div class="mb-3 w-full sm:w-1/2">
                                        <label class="block text-sm font-medium text-gray-600 mb-1">Plazo (Meses):</label>
                                        <div class="flex flex-col gap-2 justify-start">
                                            <button class="finance-term-btn px-4 py-2 border rounded-lg text-sm transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-200 data-[selected=true]:bg-pink-600 data-[selected=true]:text-white data-[selected=true]:border-pink-600" data-months="3" data-selected="true">3 Meses</button>
                                            <button class="finance-term-btn px-4 py-2 border rounded-lg text-sm transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-200" data-months="6">6 Meses</button>
                                            <button class="finance-term-btn px-4 py-2 border rounded-lg text-sm transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-200" data-months="9">9 Meses</button>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3 w-full sm:w-1/2">
                                        <label class="block text-sm font-medium text-gray-600 mb-1">Frecuencia de Pago:</label>
                                        <div class="flex flex-col gap-2 justify-start">
                                            <button class="finance-freq-btn px-4 py-2 border rounded-lg text-sm transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-200" data-frequency="semanal">Semanal</button>
                                            <button class="finance-freq-btn px-4 py-2 border rounded-lg text-sm transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-200" data-frequency="quincenal">Quincenal</button>
                                            <button class="finance-freq-btn px-4 py-2 border rounded-lg text-sm transition-colors border-gray-300 bg-white text-gray-700 hover:bg-gray-200" data-frequency="mensual" data-selected="true">Mensual</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4 text-center p-3 bg-white rounded-md shadow-inner border-t pt-3">
                                    <p class="text-sm text-gray-600 mb-1">Tu <span id="payment-label">${initialInstallment.frequencyLabel}</span> sería de:</p>
                                    <span id="installment-amount" class="text-3xl font-extrabold text-pink-600">
                                        $${initialInstallment.installment.toFixed(2)}
                                    </span>
                                    <p class="text-xs text-gray-500 mt-1">
                                        (Total Financiado: $<span id="total-financed">${initialInstallment.totalFinanced.toFixed(2)}</span> en <span id="num-payments">${initialInstallment.numPayments}</span> cuotas)
                                    </p>
                                </div>

                            </div>
                            </div>

                        ${optionsHtml}

                        <div class="flex flex-col sm:flex-row items-stretch sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-6">
                            <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden w-full sm:w-auto">
                                <button id="qty-minus" class="p-2 text-gray-600 hover:bg-gray-100 transition-colors disabled:opacity-50" disabled>-</button>
                                <input id="qty-input" type="number" value="1" min="1" max="${selectedVariant.stock}" class="w-full sm:w-12 text-center border-none focus:outline-none p-2">
                                <button id="qty-plus" class="p-2 text-gray-600 hover:bg-gray-100 transition-colors ${selectedVariant.stock <= 1 ? 'disabled:opacity-50' : ''}" ${selectedVariant.stock <= 1 ? 'disabled' : ''}>+</button>
                            </div>
                            <a id="modal-whatsapp-link" href="#" target="_blank" class="flex-1 text-center bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition-colors">
                                COMPRAR POR WHATSAPP
                            </a>
                        </div>

                        <div class="mt-6 space-y-3">
                            <button id="tab-desc-btn" class="w-full text-left p-3 rounded-lg bg-cyan-600 text-white font-bold shadow-md transition-colors duration-200">
                                DESCRIPCIÓN
                            </button>
                            <div id="tab-desc-content" class="tab-content pt-2 pb-4 text-gray-700 text-sm">
                                </div>

                            <button id="tab-specs-btn" class="w-full text-left p-3 rounded-lg bg-gray-200 text-gray-700 font-bold hover:bg-gray-300 shadow-md transition-colors duration-200">
                                ESPECIFICACIÓN
                            </button>
                            <div id="tab-specs-content" class="tab-content hidden pt-2 pb-4 text-gray-700 text-sm">
                                </div>
                        </div>
                        </div>
                </div>
            `;

            // Lógica de Pagos a Plazos
            function updateInstallmentUI() {
                const currentPrice = parseFloat(modalContent.querySelector('#modal-price').textContent.replace('$', ''));
                const selectedMonths = modalContent.querySelector('.finance-term-btn[data-selected="true"]').getAttribute('data-months');
                const selectedFrequency = modalContent.querySelector('.finance-freq-btn[data-selected="true"]').getAttribute('data-frequency');
                const quantity = parseInt(modalContent.querySelector('#qty-input').value) || 1;

                const priceToCalculate = currentPrice * quantity;

                const result = calculateInstallment(priceToCalculate, parseInt(selectedMonths), selectedFrequency);

                modalContent.querySelector('#installment-amount').textContent = `$${result.installment.toFixed(2)}`;
                modalContent.querySelector('#total-financed').textContent = result.totalFinanced.toFixed(2);
                modalContent.querySelector('#num-payments').textContent = result.numPayments;
                modalContent.querySelector('#payment-label').textContent = result.frequencyLabel;
            }

            // ACORDEÓN: Función para manejar el despliegue
            const financeContent = modalContent.querySelector('#finance-content');
            const financeToggle = modalContent.querySelector('#finance-toggle');
            const financeIcon = modalContent.querySelector('#finance-icon');
            
            financeToggle.addEventListener('click', () => {
                const isHidden = financeContent.classList.contains('finance-content-hidden');
                
                if (isHidden) {
                    financeContent.classList.remove('finance-content-hidden');
                    financeContent.classList.add('finance-content-visible');
                    financeIcon.style.transform = 'rotate(180deg)';
                } else {
                    financeContent.classList.remove('finance-content-visible');
                    financeContent.classList.add('finance-content-hidden');
                    financeIcon.style.transform = 'rotate(0deg)';
                }
                // LLAMADA CLAVE: Actualizar el enlace de WhatsApp al abrir/cerrar
                updateWhatsappLink(); 
            });

            // Manejador de botones de Plazo (Meses)
            modalContent.querySelectorAll('.finance-term-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    // Deseleccionar todos los botones de plazo
                    modalContent.querySelectorAll('.finance-term-btn').forEach(btn => btn.removeAttribute('data-selected'));
                    // Seleccionar el botón clickeado
                    e.target.setAttribute('data-selected', 'true');
                    updateInstallmentUI();
                    updateWhatsappLink();
                });
            });

            // Manejador de botones de Frecuencia
            modalContent.querySelectorAll('.finance-freq-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    // Deseleccionar todos los botones de frecuencia
                    modalContent.querySelectorAll('.finance-freq-btn').forEach(btn => btn.removeAttribute('data-selected'));
                    // Seleccionar el botón clickeado
                    e.target.setAttribute('data-selected', 'true');
                    updateInstallmentUI();
                    updateWhatsappLink();
                });
            });


            // Función para actualizar el precio y stock en el modal (y actualizar Plazos)
            function updateModalUI() {
                // Obtener las selecciones actuales
                const currentSelection = {
                    almacenamiento: modalContent.querySelector('#options-almacenamiento .option-btn[data-selected="true"]').getAttribute('data-option-value'),
                    ram: modalContent.querySelector('#options-ram .option-btn[data-selected="true"]').getAttribute('data-option-value'),
                    color: modalContent.querySelector('#options-color .option-btn[data-selected="true"]').getAttribute('data-option-value')
                };

                // Buscar la variante que coincide
                const matchedVariant = product.variants.find(v =>
                    v.almacenamiento === currentSelection.almacenamiento &&
                    v.ram === currentSelection.ram &&
                    v.color === currentSelection.color
                );

                const priceEl = modalContent.querySelector('#modal-price');
                const stockEl = modalContent.querySelector('#modal-stock');
                const qtyInput = modalContent.querySelector('#qty-input');
                const qtyPlusBtn = modalContent.querySelector('#qty-plus');
                const qtyMinusBtn = modalContent.querySelector('#qty-minus');
                const whatsappLink = modalContent.querySelector('#modal-whatsapp-link');


                if (matchedVariant) {
                    priceEl.textContent = `$${matchedVariant.priceWithTax.toFixed(2)}`;
                    stockEl.textContent = matchedVariant.stock;

                    qtyInput.max = matchedVariant.stock;
                    if (parseInt(qtyInput.value) > matchedVariant.stock || parseInt(qtyInput.value) < 1) {
                        qtyInput.value = matchedVariant.stock > 0 ? 1 : 0;
                    }

                    const hasStock = matchedVariant.stock > 0;

                    // Actualizar estado de los botones +/-
                    qtyPlusBtn.disabled = matchedVariant.stock <= parseInt(qtyInput.value);
                    qtyMinusBtn.disabled = parseInt(qtyInput.value) <= 1;

                    whatsappLink.disabled = !hasStock;
                    if (hasStock) {
                        whatsappLink.textContent = 'COMPRAR POR WHATSAPP';
                        whatsappLink.classList.add('bg-green-500', 'hover:bg-green-600');
                        whatsappLink.classList.remove('bg-gray-400', 'cursor-not-allowed');
                    } else {
                        whatsappLink.textContent = 'Sin Stock';
                        whatsappLink.classList.remove('bg-green-500', 'hover:bg-green-600');
                        whatsappLink.classList.add('bg-gray-400', 'cursor-not-allowed');
                    }

                    // Forzar la actualización del enlace de WhatsApp después de cambiar el stock/variante
                    updateWhatsappLink();
                    updateInstallmentUI(); // <--- LLAMADA CLAVE: Actualiza el cálculo de plazos
                } else {
                    priceEl.textContent = 'No disponible';
                    stockEl.textContent = '0';
                    qtyInput.max = 0;
                    qtyInput.value = 0;
                    qtyPlusBtn.disabled = true;
                    qtyMinusBtn.disabled = true;
                    whatsappLink.href = '#';
                    whatsappLink.textContent = 'Combinación No Disponible';
                    whatsappLink.classList.remove('bg-green-500', 'hover:bg-green-600');
                    whatsappLink.classList.add('bg-gray-400', 'cursor-not-allowed');
                }
            }

            // Lógica para PESTAÑAS VERTICALES
            const tabDescBtn = modalContent.querySelector('#tab-desc-btn');
            const tabSpecsBtn = modalContent.querySelector('#tab-specs-btn');
            const tabDescContent = modalContent.querySelector('#tab-desc-content');
            const tabSpecsContent = modalContent.querySelector('#tab-specs-content');

            // 1. Inyectar el contenido
            const formattedDescription = product.longDescription.replace(/\n/g, '<br>');
            tabDescContent.innerHTML = `<p>${formattedDescription}</p>`;
            const specsList = product.specs.map(spec => `<li class="mb-1">${spec}</li>`).join('');
            tabSpecsContent.innerHTML = `<ul class="list-disc list-inside space-y-1">${specsList}</ul>`;

            // 2. Función para mostrar/ocultar el contenido
            function showTabContent(tabId) {
                // Desactivar todos los contenidos
                modalContent.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

                // Reiniciar estilos de todos los botones
                tabDescBtn.classList.remove('bg-cyan-600', 'text-white');
                tabDescBtn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                tabSpecsBtn.classList.remove('bg-cyan-600', 'text-white');
                tabSpecsBtn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');


                if (tabId === 'tab-desc-content') {
                    tabDescContent.classList.remove('hidden');
                    tabDescBtn.classList.add('bg-cyan-600', 'text-white');
                    tabDescBtn.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                } else if (tabId === 'tab-specs-content') {
                    tabSpecsContent.classList.remove('hidden');
                    tabSpecsBtn.classList.add('bg-cyan-600', 'text-white');
                    tabSpecsBtn.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                }
            }

            // 3. Añadir listeners para las pestañas
            tabDescBtn.addEventListener('click', () => showTabContent('tab-desc-content'));
            tabSpecsBtn.addEventListener('click', () => showTabContent('tab-specs-content'));

            // Lógica para cantidad
            const qtyInput = modalContent.querySelector('#qty-input');
            const qtyPlusBtn = modalContent.querySelector('#qty-plus');
            const qtyMinusBtn = modalContent.querySelector('#qty-minus');

            // Función para actualizar el enlace de WhatsApp con la cantidad y el método de pago
            const updateWhatsappLink = () => {
                const currentSelection = {
                    almacenamiento: modalContent.querySelector('#options-almacenamiento .option-btn[data-selected="true"]').getAttribute('data-option-value'),
                    ram: modalContent.querySelector('#options-ram .option-btn[data-selected="true"]').getAttribute('data-option-value'),
                    color: modalContent.querySelector('#options-color .option-btn[data-selected="true"]').getAttribute('data-option-value')
                };

                const currentPrice = parseFloat(modalContent.querySelector('#modal-price').textContent.replace('$', ''));
                const quantity = parseInt(qtyInput.value) || 1;
                const totalPrice = (currentPrice * quantity).toFixed(2);
                
                // Determinar si el acordeón de financiamiento está abierto
                const isFinanceVisible = financeContent.classList.contains('finance-content-visible');
                
                let paymentDetail = ""; // Variable para el detalle del pago

                if (isFinanceVisible) {
                    // Si el acordeón está abierto, usamos el detalle de plazos
                    const selectedMonths = modalContent.querySelector('.finance-term-btn[data-selected="true"]').getAttribute('data-months');
                    const selectedFrequency = modalContent.querySelector('.finance-freq-btn[data-selected="true"]').getAttribute('data-frequency');
                    const installmentAmount = modalContent.querySelector('#installment-amount').textContent;
                    
                    // Solo el detalle de plazos
                    paymentDetail = `Pago a Plazos:\nCuota: ${installmentAmount}\nFrecuencia: ${selectedFrequency}\nPlazo: ${selectedMonths} meses.`;
                } else {
                    // Si el acordeón está cerrado, solo mostramos el precio de contado
                    paymentDetail = `Precio de Contado: $${totalPrice}.`;
                }


                const whatsappMessage = `Hola, me interesa comprar ${quantity} unidad(es) del ${product.name} con ${currentSelection.almacenamiento} de almacenamiento, ${currentSelection.ram} de RAM y color ${currentSelection.color}. \n\nDetalle de Pago:\n${paymentDetail}`;

                const whatsappLink = modalContent.querySelector('#modal-whatsapp-link');
                whatsappLink.href = `https://wa.me/593967427594?text=${encodeURIComponent(whatsappMessage)}`;

                // Actualizar estado de los botones +/-
                qtyMinusBtn.disabled = parseInt(qtyInput.value) <= 1 || parseInt(qtyInput.max) === 0;
                qtyPlusBtn.disabled = parseInt(qtyInput.value) >= parseInt(qtyInput.max) || parseInt(qtyInput.max) === 0;
            };

            qtyPlusBtn.addEventListener('click', () => {
                let currentVal = parseInt(qtyInput.value);
                if (currentVal < parseInt(qtyInput.max)) {
                    qtyInput.value = currentVal + 1;
                }
                updateWhatsappLink();
                updateInstallmentUI(); // Actualizar plazos al cambiar cantidad
            });

            qtyMinusBtn.addEventListener('click', () => {
                let currentVal = parseInt(qtyInput.value);
                if (currentVal > 1) {
                    qtyInput.value = currentVal - 1;
                }
                updateWhatsappLink();
                updateInstallmentUI(); // Actualizar plazos al cambiar cantidad
            });

            qtyInput.addEventListener('change', () => {
                let currentVal = parseInt(qtyInput.value);
                const maxVal = parseInt(qtyInput.max);
                if (currentVal < 1) qtyInput.value = 1;
                if (currentVal > maxVal) qtyInput.value = maxVal;
                updateWhatsappLink();
                updateInstallmentUI(); // Actualizar plazos al cambiar cantidad
            });

            // Lógica para las opciones de selección
            modalContent.querySelectorAll('.option-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const optionType = e.target.getAttribute('data-option-type');
                    // Deseleccionar todas las opciones del mismo tipo
                    modalContent.querySelectorAll(`.option-btn[data-option-type="${optionType}"]`).forEach(btn => {
                        btn.removeAttribute('data-selected');
                    });
                    // Seleccionar la opción actual
                    e.target.setAttribute('data-selected', 'true');

                    updateModalUI();
                });
            });

            // Mostrar la pestaña de descripción por defecto y actualizar la UI
            showTabContent('tab-desc-content');
            updateModalUI(); // Llamada inicial para el primer render
            modal.classList.remove('hidden');
        }

        // 4. Función para ocultar el modal
        function hideModal() {
            document.getElementById('info-modal').classList.add('hidden');
        }

        // 5. Función para cambiar de página
        function showPage(pageId) {
            document.querySelectorAll('.content-page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId).classList.remove('hidden');

            // Cierra el menú móvil al navegar
            const mobileMenu = document.getElementById('mobile-menu');
            if (!mobileMenu.classList.contains('hidden')) {
                toggleMenu(); // Llama a la función para cerrar el menú si está abierto
            }
        }

        // 6. Función para el menú hamburguesa
        function toggleMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            const menuOpenIcon = document.getElementById('menu-icon-open');
            const menuCloseIcon = document.getElementById('menu-icon-close');

            mobileMenu.classList.toggle('hidden');
            menuOpenIcon.classList.toggle('hidden');
            menuCloseIcon.classList.toggle('hidden');
        }

        // 7. Función para actualizar el catálogo con búsqueda y ordenamiento
        function updateCatalog() {
            const searchInput = document.getElementById('search-input');
            const sortSelect = document.getElementById('sort-order');
            if (!searchInput || !sortSelect) return;

            const searchTerm = searchInput.value.toLowerCase();
            const sortOrder = sortSelect.value;

            let filteredProducts = products.filter(product => {
                const name = product.name.toLowerCase();
                const shortDescription = product.shortDescription.toLowerCase();
                const longDescription = product.longDescription.toLowerCase();
                // Busca también en las marcas
                const brand = product.brand.toLowerCase();
                return name.includes(searchTerm) || shortDescription.includes(searchTerm) || longDescription.includes(searchTerm) || brand.includes(searchTerm);
            });

            if (sortOrder === 'name') {
                filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sortOrder === 'price') {
                // Ordena por el precio con impuestos de la primera variante
                filteredProducts.sort((a, b) => a.variants[0].priceWithTax - b.variants[0].priceWithTax);
            }

            renderProducts(filteredProducts);
        }

        // 8. Manejadores de eventos

        // Manejador del botón hamburguesa
        document.getElementById('menu-toggle').addEventListener('click', toggleMenu);

        // Función de utilidad para manejar la navegación
        const setupNavigation = (btnId, pageId) => {
            document.getElementById(btnId).addEventListener('click', () => {
                showPage(pageId);
                if (pageId === 'page-catalogo') {
                    updateCatalog();
                }
            });
        };

        // Configuración de navegación para Escritorio y Móvil
        setupNavigation('btn-inicio', 'page-inicio');
        setupNavigation('btn-catalogo', 'page-catalogo');
        setupNavigation('btn-nosotros', 'page-nosotros');
        setupNavigation('btn-contacto', 'page-contacto');
        setupNavigation('mobile-btn-inicio', 'page-inicio');
        setupNavigation('mobile-btn-catalogo', 'page-catalogo');
        setupNavigation('mobile-btn-nosotros', 'page-nosotros');
        setupNavigation('mobile-btn-contacto', 'page-contacto');


        // Manejador para el botón "Ver Catálogo Ahora"
        document.getElementById('btn-ir-catalogo').addEventListener('click', () => {
            showPage('page-catalogo');
            updateCatalog();
        });

        // Manejadores de eventos para búsqueda y ordenamiento
        document.getElementById('search-input').addEventListener('input', updateCatalog);
        document.getElementById('sort-order').addEventListener('change', updateCatalog);

        // Manejador de evento para cerrar el modal
        document.getElementById('close-modal').addEventListener('click', hideModal);
        document.getElementById('info-modal').addEventListener('click', (event) => {
            if (event.target === event.currentTarget) {
                hideModal();
            }
        });

        // Manejador de evento para el formulario de contacto
        document.getElementById('contact-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const message = document.getElementById('message').value;
            const subject = "Reclamo o sugerencia de " + name;
            const body = `Nombre: ${name}\nCorreo: ${email}\n\nMensaje:\n${message}`;
            const mailtoLink = `mailto:moormixdigital@outloo.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

            window.location.href = mailtoLink;

            const formMessage = document.getElementById('form-message');
            formMessage.textContent = "Tu mensaje ha sido enviado a tu cliente de correo para su confirmación.";
            formMessage.classList.remove('hidden');
            formMessage.classList.add('text-green-600');

            setTimeout(() => {
                document.getElementById('contact-form').reset();
                formMessage.classList.add('hidden');
            }, 5000);
        });

        // 9. Inicialización de la aplicación
        document.addEventListener('DOMContentLoaded', () => {
            showPage('page-inicio');
            updateCatalog();
        });

    </script>
</body>
</html>
